(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c9d1342"],{"039a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"所属主机"},model:{value:t.form.clusterClientId,callback:function(e){t.$set(t.form,"clusterClientId",e)},expression:"form.clusterClientId"}},t._l(t.options,(function(e){return a("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)})),1),t._v(" "),a("el-select",{staticClass:"filter-item",attrs:{placeholder:"schemas"},on:{change:function(e){return t.queryData()}},model:{value:t.listQuery.schema,callback:function(e){t.$set(t.listQuery,"schema",e)},expression:"listQuery.schema"}},t._l(t.schemas,(function(t){return a("el-option",{key:t.schemaName,attrs:{label:t.schemaName,value:t.schemaName}})})),1),t._v(" "),a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择 Adapter 种类"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},[a("el-option",{key:"hbase",attrs:{label:"HBase",value:"hbase"}}),t._v(" "),a("el-option",{key:"rdb",attrs:{label:"RDB",value:"rdb"}}),t._v(" "),a("el-option",{key:"es6x",attrs:{label:"Elastic Search 6.x",value:"es6x"}}),t._v(" "),a("el-option",{key:"es7x",attrs:{label:"Elastic Search 7.x",value:"es7x"}}),t._v(" "),a("el-option",{key:"kudu",attrs:{label:"Apache Kudu",value:"kudu"}})],1),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(e){return t.handleTemplate()}}},[t._v("编辑模板")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(e){t.dialogTipVisible=!0}}},[t._v("保存")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"info"},on:{click:function(e){return t.fetchData()}}},[t._v("刷新列表")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"info"},on:{click:t.onBack}},[t._v("返回")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),a("el-table-column",{attrs:{label:"Table","min-width":"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.tableSchema)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"Table","min-width":"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.tableName)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",{attrs:{trigger:"click"}},[a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("\n            操作"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return t.previewTemplate(e.row)}}},[t._v("预览")])],1)],1)]}}])})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogTemplateVisible,title:"Adapter 模板 (Thymeleaf)",width:"800px"},on:{"update:visible":function(e){t.dialogTemplateVisible=e}}},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"info"},on:{click:function(e){return t.handleSaveTemplate()}}},[t._v("保存")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"success"},on:{click:function(e){return t.onLoadTemplate()}}},[t._v("载入模板")])],1),t._v(" "),a("editor",{attrs:{lang:"properties",theme:"chrome",width:"100%",height:800},on:{init:t.editorInit},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogTemplatePreviewVisible,title:"Adapter 模板",width:"800px"},on:{"update:visible":function(e){t.dialogTemplatePreviewVisible=e}}},[a("editor",{attrs:{lang:"properties",theme:"chrome",width:"100%",height:800},on:{init:t.editorInit},model:{value:t.previewContent,callback:function(e){t.previewContent=e},expression:"previewContent"}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogTemplatePreviewVisible,title:"Adapter 模板",width:"800px"},on:{"update:visible":function(e){t.dialogTemplatePreviewVisible=e}}},[a("editor",{attrs:{lang:"properties",theme:"chrome",width:"100%",height:800},on:{init:t.editorInit},model:{value:t.previewContent,callback:function(e){t.previewContent=e},expression:"previewContent"}})],1),t._v(" "),a("el-dialog",{attrs:{title:"提示",visible:t.dialogTipVisible,width:"30%"},on:{"update:visible":function(e){t.dialogTipVisible=e}}},[a("span",[t._v("确定要批量新增Adapter？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogTipVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("确 定")])],1)])],1)},i=[],r=(a("ac6a"),a("5aad")),l=a("b775");function o(){return Object(l["a"])({url:"/canal/srcDataSource/schemas",method:"get"})}function s(t){return Object(l["a"])({url:"/canal/srcDataSource/schemas/"+t+"/tables",method:"get"})}var c=a("d631"),u={components:{editor:a("7c9e")},filters:{},data:function(){return{list:[],listLoading:!0,schemas:[],form:{category:"",clusterClientId:"",content:""},options:[],dialogTemplatePreviewVisible:!1,dialogTemplateVisible:!1,dialogTipVisible:!1,previewContent:"",listQuery:{schema:null}}},created:function(){var t=this;Object(c["d"])().then((function(e){t.options=e.data})),o().then((function(e){t.schemas=e.data})),this.fetchData()},methods:{editorInit:function(){a("2099"),a("be9d"),a("2968"),a("e0e5"),a("bb36"),a("0329"),a("95b8"),a("6a21")},queryData:function(){this.fetchData()},fetchData:function(){var t=this;this.listLoading=!0,s(this.listQuery.schema).then((function(e){t.list=e.data})).finally((function(){t.listLoading=!1}))},handleCreate:function(){var t=this,e=this.$refs.multipleTable.selection;if(0!==e.length){var a=[];e.forEach((function(e){a.push({name:e.tableSchema+"::"+e.tableName+".yml",clusterClientId:t.form.clusterClientId,category:t.form.category,content:t.form.content})})),""!==this.form.clusterClientId?""!==this.form.category?""!==this.form.content?Object(r["b"])(a).then((function(e){t.$router.push("/canalClient/canalAdapters")})):this.$message({message:"请编辑模板",type:"error"}):this.$message({message:"请输入Adapter种类",type:"error"}):this.$message({message:"请选择集群/主机",type:"error"})}else this.$message({message:"请选择Table",type:"error"})},handleTemplate:function(){""!==this.form.category?this.dialogTemplateVisible=!0:this.$message({message:"请输入Adapter种类",type:"error"})},onLoadTemplate:function(){var t=this,e={category:this.form.category};Object(r["g"])(e).then((function(e){null!==e.data&&""!==e.data||t.$message({message:"未找到预留模版，请自行编辑",type:"error"}),t.form.content=e.data}))},handleSaveTemplate:function(){this.dialogTemplateVisible=!1},previewTemplate:function(t){var e=this;this.dialogTemplatePreviewVisible=!0;var a={name:t.tableSchema+"::"+t.tableName+".yml",clusterClientId:this.form.clusterClientId,category:this.form.category,content:this.form.content};Object(r["i"])(a).then((function(t){e.previewContent=t.data}))},onBack:function(){history.go(-1)}}},d=u,m=a("2877"),p=Object(m["a"])(d,n,i,!1,null,null,null);e["default"]=p.exports},"5aad":function(t,e,a){"use strict";a.d(e,"e",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"j",(function(){return l})),a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return s})),a.d(e,"d",(function(){return c})),a.d(e,"f",(function(){return u})),a.d(e,"g",(function(){return d})),a.d(e,"i",(function(){return m}));var n=a("b775");function i(t){return Object(n["a"])({url:"/canal/adapters",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/canal/adapter/"+t,method:"get"})}function l(t){return Object(n["a"])({url:"/canal/adapter",method:"put",data:t})}function o(t){return Object(n["a"])({url:"/canal/adapter",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/canal/adapters/batch",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/canal/adapter/"+t,method:"delete"})}function u(t){return Object(n["a"])({url:"/canal/adapter/template",method:"get",params:t})}function d(t){return Object(n["a"])({url:"/canal/adapter/template/engine",method:"get",params:t})}function m(t){return Object(n["a"])({url:"/canal/adapter/template/engine/preview?_method=get",method:"post",data:t})}},d631:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return l})),a.d(e,"b",(function(){return o})),a.d(e,"e",(function(){return s})),a.d(e,"d",(function(){return c}));var n=a("b775");function i(t){return Object(n["a"])({url:"/canal/clusters",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/canal/cluster",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/canal/cluster",method:"put",data:t})}function o(t){return Object(n["a"])({url:"/canal/cluster/"+t,method:"delete"})}function s(){return Object(n["a"])({url:"/canal/clustersAndServers",method:"get"})}function c(){return Object(n["a"])({url:"/canal/clustersAndClients",method:"get"})}}}]);